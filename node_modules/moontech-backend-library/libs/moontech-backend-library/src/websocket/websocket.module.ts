import { DynamicModule, Module } from '@nestjs/common';
import { WebsocketConfig } from './websocket-config';
import { WebsocketGateway } from './websocket.gateway';

/**
 * This module implements Websockets
 */
@Module({
  imports: [],
  controllers: [],
  providers: [WebsocketGateway],
  exports: [WebsocketGateway],
})
export class WebsocketModule {
  static register(options: WebsocketConfig): DynamicModule {
    return {
        module: WebsocketModule,
        providers: [
          {
              provide: 'CONFIG_OPTIONS',
              useValue: options,
          },
          /*{
            provide: 'WEBGATEWAY',
            useClass: WebsocketGateway,
            inject: [WebsocketGateway]
          },*/
          WebsocketGateway,
        ],
        exports: [
          WebsocketGateway
        ],
        global: true
    };
  }
}
